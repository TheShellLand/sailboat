#!/bin/bash
# SmartOS script starting VMs
#
# There comes a time when you start a VM and want to know how to connect to it
# You could run the commands separately, or just use this and tell it the UUID
# and it'll do the rest for you
#


function startvm(){

    vmadm list
    while true; do
    read -p "Enter VM UUID: " INFO
    vmadm list | grep -w "$INFO" 2>/dev/null >/dev/null
      if [ $? == 0 ]; then break
        else echo "UUID not found. Please check spelling and try again"; fi
    done

    while true; do
        vmadm start "$INFO"
        while true; do
          echo "[*] Awaiting network"
          if [ "$BRAND" == joyent ]; then zlogin "$INFO" ipadm show-addr; fi
          if [ "$BRAND" == lx ]; then zlogin "$INFO" ip a; fi
          if [ "$BRAND" == kvm ]; then vmadm info "$INFO" vnc; fi
          echo ""
          read -p "Press enter to refresh network lookup, or ^C to exit"
        done
    done
    echo ""
    return $?

}



# main

startvm